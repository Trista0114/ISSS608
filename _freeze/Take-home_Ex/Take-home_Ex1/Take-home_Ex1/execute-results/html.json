{
  "hash": "e49acaeb65fc79d94bd1032eb37fe953",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Chen.PengWei\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n\n1.  Overview\\\n    1.1 Background\\\n    1.2 Objective\n\n    Analyze the profitability of different ship types\\\n    What is the most profitable ship type?\\\n    Which ship type generates the highest revenue? Which costs the least?\n\n    \\\n    Analyze the trend of different ship types\\\n    What is the trend of the profit in different ship type\\\n    \\\n    Analyze what numerical variable influence the profit the most\\\n    \\\n    \\\n    Exploratory Data Analysis (EDA): Identify trends and patterns in ship performance and operational efficiency.\\\n    Clustering Analysis: Segment ships based on performance metrics and categorical attributes.\\\n\n2.  Getting started\n\nInstalling Libraries\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggplot2,dplyr,DT,crosstalk,patchwork,plotlyhaven,SmartEDA,tidyverse,tidymodels,ggdist,ggridges, ggthemes,colorspace,scales,ggiraph)\n```\n:::\n\n\n\n\nImporting Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship_original <- read_csv(\"data/Ship_Performance_Dataset.csv\")\n```\n:::\n\n\n\n\nPrepare data\\\nSelect variable and filtering data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship = ship_original %>% filter(Ship_Type != \"None\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nship\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,600 × 18\n   Date       Ship_Type      Route_Type   Engine_Type         Maintenance_Status\n   <date>     <chr>          <chr>        <chr>               <chr>             \n 1 2023-06-04 Container Ship None         Heavy Fuel Oil (HF… Critical          \n 2 2023-06-11 Fish Carrier   Short-haul   Steam Turbine       Good              \n 3 2023-06-18 Container Ship Long-haul    Diesel              Fair              \n 4 2023-06-25 Bulk Carrier   Transoceanic Steam Turbine       Fair              \n 5 2023-07-02 Fish Carrier   Transoceanic Diesel              Fair              \n 6 2023-07-09 Fish Carrier   Long-haul    Heavy Fuel Oil (HF… Fair              \n 7 2023-07-16 Fish Carrier   Transoceanic Heavy Fuel Oil (HF… Critical          \n 8 2023-07-23 Container Ship Short-haul   Diesel              Critical          \n 9 2023-08-06 Container Ship Long-haul    Diesel              Fair              \n10 2023-08-13 Fish Carrier   Short-haul   Steam Turbine       Fair              \n# ℹ 2,590 more rows\n# ℹ 13 more variables: Speed_Over_Ground_knots <dbl>, Engine_Power_kW <dbl>,\n#   Distance_Traveled_nm <dbl>, Draft_meters <dbl>, Weather_Condition <chr>,\n#   Cargo_Weight_tons <dbl>, Operational_Cost_USD <dbl>,\n#   Revenue_per_Voyage_USD <dbl>, Turnaround_Time_hours <dbl>,\n#   Efficiency_nm_per_kWh <dbl>, Seasonal_Impact_Score <dbl>,\n#   Weekly_Voyage_Count <dbl>, Average_Load_Percentage <dbl>\n```\n\n\n:::\n:::\n\n\n\n\nchecking missing value\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(ship))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   Date               Ship_Type              Route_Type \n                      0                       0                       0 \n            Engine_Type      Maintenance_Status Speed_Over_Ground_knots \n                      0                       0                       0 \n        Engine_Power_kW    Distance_Traveled_nm            Draft_meters \n                      0                       0                       0 \n      Weather_Condition       Cargo_Weight_tons    Operational_Cost_USD \n                      0                       0                       0 \n Revenue_per_Voyage_USD   Turnaround_Time_hours   Efficiency_nm_per_kWh \n                      0                       0                       0 \n  Seasonal_Impact_Score     Weekly_Voyage_Count Average_Load_Percentage \n                      0                       0                       0 \n```\n\n\n:::\n:::\n\n\n\n\ncreate profit variable\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship <- ship %>%\n  mutate(profit = Revenue_per_Voyage_USD - Operational_Cost_USD)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 19\n  Date       Ship_Type      Route_Type   Engine_Type          Maintenance_Status\n  <date>     <chr>          <chr>        <chr>                <chr>             \n1 2023-06-04 Container Ship None         Heavy Fuel Oil (HFO) Critical          \n2 2023-06-11 Fish Carrier   Short-haul   Steam Turbine        Good              \n3 2023-06-18 Container Ship Long-haul    Diesel               Fair              \n4 2023-06-25 Bulk Carrier   Transoceanic Steam Turbine        Fair              \n5 2023-07-02 Fish Carrier   Transoceanic Diesel               Fair              \n6 2023-07-09 Fish Carrier   Long-haul    Heavy Fuel Oil (HFO) Fair              \n# ℹ 14 more variables: Speed_Over_Ground_knots <dbl>, Engine_Power_kW <dbl>,\n#   Distance_Traveled_nm <dbl>, Draft_meters <dbl>, Weather_Condition <chr>,\n#   Cargo_Weight_tons <dbl>, Operational_Cost_USD <dbl>,\n#   Revenue_per_Voyage_USD <dbl>, Turnaround_Time_hours <dbl>,\n#   Efficiency_nm_per_kWh <dbl>, Seasonal_Impact_Score <dbl>,\n#   Weekly_Voyage_Count <dbl>, Average_Load_Percentage <dbl>, profit <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n3.**Exploratory Data Analysis- ship type**\n\n3.1 ship type\\\nship type & profit\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ship, aes(x = Ship_Type, y = profit)) +\n  stat_halfeye(adjust = 0.5, \n               justification = -0.1, \n               .width = 0, \n               point_colour = NA, \n               fill = \"gray\", \n               alpha = 0.5) +  # 設定透明度\n  geom_boxplot(width = 0.20, \n               outlier.shape = NA, \n               fill = \"white\", \n               color = \"black\") +  \n  stat_summary(fun = mean,  \n               geom = \"point\", \n               size = 1, \n               color = \"red\",\n               fill = \"red\") +\n  labs(title = \"Profit Distribution by Ship Type\",\n       x = \"Ship Type\", y = \"Profit (USD)\") +\n  theme_minimal() + theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\nship type & avg profit\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship_avg_profit <- as.data.frame(ship) %>%\n  group_by(Ship_Type) %>%\n  summarise(Average_Profit = mean(profit, na.rm = TRUE))\n\ny_min <- floor(min(ship_avg_profit$Average_Profit) / 1000) * 1000  # 取最小千位\ny_max <- ceiling(max(ship_avg_profit$Average_Profit) / 1000) * 1000  # 取最大千位\ny_breaks <- seq(y_min, y_max, by = 5000)  # 設定間距為 2000 (可調整)\ny_lower_limit <- y_min - 5000  # ✅ 讓 Y 軸從比最小值稍低的位置開始\n\n# 自定義 Tooltip 顯示格式 (僅顯示平均利潤)\ntooltip <- function(y, accuracy = 1) {\n  profit <- scales::number(y, accuracy = accuracy, big.mark = \",\")\n  paste(\"Average Profit: \", profit, \"USD\")\n}\n\n# 繪製互動式長條圖 (含 tooltip)\ngg_point <- ggplot(data = ship_avg_profit, \n                   aes(x = Ship_Type, y = Average_Profit)) +\n  geom_col_interactive(aes(tooltip = tooltip(Average_Profit)),  \n                       fill = \"lightblue\") +  # ✅ 只顯示平均利潤\n  scale_y_continuous(breaks = y_breaks, labels = scales::comma) +  # ✅ 設定 Y 軸間距\n  coord_cartesian(ylim = c(y_lower_limit, y_max)) +  # ✅ 不讓 Y 軸從 0 開始\n  labs(title = \"Average Profit by Ship Type\", \n       x = \"Ship Type\", y = \"Average Profit (USD)\") +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_text(size = 10, angle = 0, hjust = 1),  # ✅ 調整 Y 軸標籤字體大小\n    axis.text.x = element_text(size = 12),  # ✅ 調整 X 軸標籤字體大小\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\")  # ✅ 讓標題置中 & 加粗\n  )\n\n# 轉換為互動式圖表\ngirafe(ggobj = gg_point, width_svg = 8, height_svg = 8 * 0.618)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"girafe html-widget html-fill-item\" id=\"htmlwidget-fc1ad390f58068e25e1b\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fc1ad390f58068e25e1b\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='graphics-document' id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed' viewBox='0 0 576 355.97'>\\n <defs id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_defs'>\\n  <clipPath id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_c1'>\\n   <rect x='0' y='0' width='576' height='355.97'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_c2'>\\n   <rect x='59.52' y='23.93' width='511' height='297.58'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_c1)'>\\n   <rect x='0' y='0' width='576' height='355.97' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_c2)'>\\n   <polyline points='59.52,307.98 570.52,307.98' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,283.82 570.52,283.82' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,235.52 570.52,235.52' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,187.21 570.52,187.21' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,138.90 570.52,138.90' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,90.59 570.52,90.59' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,42.28 570.52,42.28' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,259.67 570.52,259.67' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,211.36 570.52,211.36' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,163.05 570.52,163.05' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,114.75 570.52,114.75' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='59.52,66.44 570.52,66.44' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='132.52,321.51 132.52,23.93' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='254.19,321.51 254.19,23.93' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='375.85,321.51 375.85,23.93' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='497.52,321.51 497.52,23.93' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <rect id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_e1' x='77.77' y='140.44' width='109.5' height='2553.96' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Average Profit:  264,340 USD'/>\\n   <rect id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_e2' x='199.44' y='124.23' width='109.5' height='2570.18' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Average Profit:  266,019 USD'/>\\n   <rect id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_e3' x='321.1' y='40.24' width='109.5' height='2654.17' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Average Profit:  274,711 USD'/>\\n   <rect id='svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_e4' x='442.77' y='254.49' width='109.5' height='2439.92' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Average Profit:  252,536 USD'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed_c1)'>\\n   <text x='18.41' y='263.25' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>252,000<\\/text>\\n   <text x='18.41' y='214.94' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>257,000<\\/text>\\n   <text x='18.41' y='166.64' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>262,000<\\/text>\\n   <text x='18.41' y='118.33' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>267,000<\\/text>\\n   <text x='18.41' y='70.02' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>272,000<\\/text>\\n   <text x='100.84' y='335.03' font-size='9pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bulk Carrier<\\/text>\\n   <text x='214.49' y='335.03' font-size='9pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Container Ship<\\/text>\\n   <text x='344.52' y='335.03' font-size='9pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Fish Carrier<\\/text>\\n   <text x='479.51' y='335.03' font-size='9pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Tanker<\\/text>\\n   <text x='290.65' y='348.17' font-size='8.25pt' font-family='Arial'>Ship Type<\\/text>\\n   <text transform='translate(13.36,224.28) rotate(-90.00)' font-size='8.25pt' font-family='Arial'>Average Profit (USD)<\\/text>\\n   <text x='222.48' y='15.5' font-size='10.5pt' font-weight='bold' font-family='Arial'>Average Profit by Ship Type<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_5a0878a0_0c53_4a3d_b349_406b1aece9ed\",\"ratio\":1.618122977346278,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":10,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_data_SVGID_ { stroke:orange; }\",\"reactive\":true,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_data_SVGID_ { stroke:none;fill:red; }\\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\\nimage.select_data_SVGID_ { stroke:red; }\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"fixed\":false,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ✅ 讓 Tooltip 同時顯示 Revenue & Cost\nship_avg_data <- (ship) %>%\n  group_by(Ship_Type) %>%\n  summarise(\n    Avg_Revenue = mean(Revenue_per_Voyage_USD, na.rm = TRUE),\n    Avg_Cost = mean(Operational_Cost_USD, na.rm = TRUE)\n  )\n\n\n# 設定各自的 Y 軸範圍\ny_min_cost <- floor(min(ship_avg_data$Avg_Cost) / 1000) * 1000\ny_max_cost <- ceiling(max(ship_avg_data$Avg_Cost) / 1000) * 1000\ny_breaks_cost <- seq(y_min_cost, y_max_cost, by = 2000)\n\ny_min_revenue <- floor(min(ship_avg_data$Avg_Revenue) / 1000) * 1000\ny_max_revenue <- ceiling(max(ship_avg_data$Avg_Revenue) / 1000) * 1000\ny_breaks_revenue <- seq(y_min_revenue, y_max_revenue, by = 5000)\n\n\np1 <- ggplot((ship_avg_data), \n             aes(x = Ship_Type, y = Avg_Cost)) +\n  geom_col_interactive(\n    aes(tooltip = paste0(\"Avg Cost: \", scales::comma(Avg_Cost), \" USD\",\n                         \"\\nAvg Revenue: \", scales::comma(Avg_Revenue), \" USD\"),\n        data_id = Ship_Type),\n    fill = \"salmon\"\n  ) +\n  scale_y_continuous(breaks = y_breaks_cost, labels = scales::comma) +  \n  coord_cartesian(ylim = c(y_min_cost - 500, y_max_cost)) +  \n  labs(title = \"Average Operational Cost\", x = \"Ship Type\", y = \"Avg Cost (USD)\") +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_text(size = 10, angle = 0, hjust = 1),\n    axis.text.x = element_text(size = 5, angle = 0),\n    plot.title = element_text(hjust = 0.5, size = 10, face = \"bold\"),\n    axis.title.x = element_text(size = 10),  # X 軸標題字體大小\n    axis.title.y = element_text(size = 10)\n  )\n\n# ✅ 讓 Revenue 長條圖也顯示 Cost\np2 <- ggplot((ship_avg_data), \n             aes(x = Ship_Type, y = Avg_Revenue)) +\n  geom_col_interactive(\n    aes(tooltip = paste0(\"Avg Revenue: \", scales::comma(Avg_Revenue), \" USD\",\n                         \"\\nAvg Cost: \", scales::comma(Avg_Cost), \" USD\"),\n        data_id = Ship_Type),\n    fill = \"lightblue\"\n  ) +\n  scale_y_continuous(breaks = y_breaks_revenue, labels = scales::comma) +  \n  coord_cartesian(ylim = c(y_min_revenue - 5000, y_max_revenue)) +  \n  labs(title = \"Average Revenue per Voyage\", x = \"Ship Type\", y = \"Avg Revenue (USD)\") +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_text(size = 10, angle = 0, hjust = 1),\n    axis.text.x = element_text(size = 5, angle = 0),\n    plot.title = element_text(hjust = 0.5, size = 10, face = \"bold\"),\n    axis.title.x = element_text(size = 10),  # X 軸標題字體大小\n    axis.title.y = element_text(size = 10)\n  )\n\n# ✅ 讓 Tooltip 顯示 Revenue & Cost\ngirafe(\n  code = print(p1 + p2), \n  width_svg = 6,\n  height_svg = 3,\n  options = list(\n    opts_hover(css = \"fill: gray;\"),\n    opts_selection(type = \"single\")  # ✅ 確保點擊時只選擇單一 Ship_Type\n  )\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"girafe html-widget html-fill-item\" id=\"htmlwidget-b27a0c623600a221660d\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b27a0c623600a221660d\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='graphics-document' id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0' viewBox='0 0 432 216'>\\n <defs id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_defs'>\\n  <clipPath id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c1'>\\n   <rect x='0' y='0' width='432' height='216'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c2'>\\n   <rect x='64.07' y='25.7' width='356.97' height='157.77'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c3'>\\n   <rect x='5.48' y='5.48' width='210.52' height='205.04'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c4'>\\n   <rect x='216' y='5.48' width='210.52' height='205.04'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c5'>\\n   <rect x='64.07' y='25.7' width='146.45' height='157.77'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c6'>\\n   <rect x='274.59' y='25.7' width='146.45' height='157.77'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c1)'>\\n   <rect x='0' y='0' width='432' height='216' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n   <rect x='0' y='0' width='432' height='216' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c5)'>\\n   <polyline points='64.07,143.20 210.52,143.20' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='64.07,99.07 210.52,99.07' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='64.07,54.94 210.52,54.94' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='64.07,165.27 210.52,165.27' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='64.07,121.14 210.52,121.14' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='64.07,77.01 210.52,77.01' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='64.07,32.88 210.52,32.88' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='84.99,183.47 84.99,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='119.86,183.47 119.86,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='154.73,183.47 154.73,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='189.60,183.47 189.60,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e1' x='69.3' y='102.38' width='31.38' height='5645.49' fill='#FA8072' fill-opacity='1' stroke='none' title='Avg Cost: 255,850 USD&amp;lt;br/&amp;gt;Avg Revenue: 520,190 USD' data-id='Bulk Carrier'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e2' x='104.17' y='42.97' width='31.38' height='5704.9' fill='#FA8072' fill-opacity='1' stroke='none' title='Avg Cost: 258,543 USD&amp;lt;br/&amp;gt;Avg Revenue: 524,561 USD' data-id='Container Ship'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e3' x='139.04' y='120.8' width='31.38' height='5627.07' fill='#FA8072' fill-opacity='1' stroke='none' title='Avg Cost: 255,015 USD&amp;lt;br/&amp;gt;Avg Revenue: 529,727 USD' data-id='Fish Carrier'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e4' x='173.91' y='155.8' width='31.38' height='5592.06' fill='#FA8072' fill-opacity='1' stroke='none' title='Avg Cost: 253,429 USD&amp;lt;br/&amp;gt;Avg Revenue: 505,965 USD' data-id='Tanker'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c1)'>\\n   <text x='22.97' y='168.85' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>253,000<\\/text>\\n   <text x='22.97' y='124.72' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>255,000<\\/text>\\n   <text x='22.97' y='80.59' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>257,000<\\/text>\\n   <text x='22.97' y='36.46' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>259,000<\\/text>\\n   <text x='71.8' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bulk Carrier<\\/text>\\n   <text x='103.33' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Container Ship<\\/text>\\n   <text x='141.68' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Fish Carrier<\\/text>\\n   <text x='182.1' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Tanker<\\/text>\\n   <text x='115.14' y='202.94' font-size='7.5pt' font-family='Arial'>Ship Type<\\/text>\\n   <text transform='translate(18.12,140.07) rotate(-90.00)' font-size='7.5pt' font-family='Arial'>Avg Cost (USD)<\\/text>\\n   <text x='76.06' y='18.12' font-size='7.5pt' font-weight='bold' font-family='Arial'>Average Operational Cost<\\/text>\\n  <\\/g>\\n  <g clip-path='url(#svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c6)'>\\n   <polyline points='274.59,176.30 421.04,176.30' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,164.35 421.04,164.35' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,140.45 421.04,140.45' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,116.54 421.04,116.54' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,92.64 421.04,92.64' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,68.73 421.04,68.73' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,44.83 421.04,44.83' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.53' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,152.40 421.04,152.40' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,128.49 421.04,128.49' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,104.59 421.04,104.59' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,80.68 421.04,80.68' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,56.78 421.04,56.78' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='274.59,32.88 421.04,32.88' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='295.51,183.47 295.51,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='330.38,183.47 330.38,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='365.25,183.47 365.25,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='400.12,183.47 400.12,25.70' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e5' x='279.82' y='79.78' width='31.38' height='2486.97' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Avg Revenue: 520,190 USD&amp;lt;br/&amp;gt;Avg Cost: 255,850 USD' data-id='Bulk Carrier'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e6' x='314.69' y='58.88' width='31.38' height='2507.87' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Avg Revenue: 524,561 USD&amp;lt;br/&amp;gt;Avg Cost: 258,543 USD' data-id='Container Ship'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e7' x='349.56' y='34.18' width='31.38' height='2532.56' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Avg Revenue: 529,727 USD&amp;lt;br/&amp;gt;Avg Cost: 255,015 USD' data-id='Fish Carrier'/>\\n   <rect id='svg_dd121080_a304_49f2_ade3_f3ddf92706a0_e8' x='384.43' y='147.78' width='31.38' height='2418.96' fill='#ADD8E6' fill-opacity='1' stroke='none' title='Avg Revenue: 505,965 USD&amp;lt;br/&amp;gt;Avg Cost: 253,429 USD' data-id='Tanker'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_dd121080_a304_49f2_ade3_f3ddf92706a0_c1)'>\\n   <text x='233.49' y='155.98' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>505,000<\\/text>\\n   <text x='233.49' y='132.08' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>510,000<\\/text>\\n   <text x='233.49' y='108.17' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>515,000<\\/text>\\n   <text x='233.49' y='84.27' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>520,000<\\/text>\\n   <text x='233.49' y='60.36' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>525,000<\\/text>\\n   <text x='233.49' y='36.46' font-size='7.5pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>530,000<\\/text>\\n   <text x='282.32' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Bulk Carrier<\\/text>\\n   <text x='313.85' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Container Ship<\\/text>\\n   <text x='352.2' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Fish Carrier<\\/text>\\n   <text x='392.62' y='191.98' font-size='3.75pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>Tanker<\\/text>\\n   <text x='325.66' y='202.94' font-size='7.5pt' font-family='Arial'>Ship Type<\\/text>\\n   <text transform='translate(228.64,149.81) rotate(-90.00)' font-size='7.5pt' font-family='Arial'>Avg Revenue (USD)<\\/text>\\n   <text x='278.04' y='18.12' font-size='7.5pt' font-weight='bold' font-family='Arial'>Average Revenue per Voyage<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_dd121080_a304_49f2_ade3_f3ddf92706a0\",\"ratio\":2,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":10,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill: gray; }\",\"reactive\":false,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:gray; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"fixed\":false,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/d3-bundle-5.16.0/d3-bundle.min.js\"></script>\n<script src=\"../../site_libs/d3-lasso-0.0.5/d3-lasso.min.js\"></script>\n<script src=\"../../site_libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js\"></script>\n<script src=\"../../site_libs/flatbush-4.4.0/flatbush.min.js\"></script>\n<link href=\"../../site_libs/ggiraphjs-0.8.10/ggiraphjs.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/ggiraphjs-0.8.10/ggiraphjs.min.js\"></script>\n<script src=\"../../site_libs/girafe-binding-0.8.12/girafe.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}